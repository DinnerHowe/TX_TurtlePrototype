<!--this file is demo for nav with auto obstacle avoidance -->
<launch>
  <arg name="custom_param_file" default="$(find nav_staff)/param/dummy.yaml"/>
  <param name="use_sim_time" value="false" />
  
  <!--map saver-->
  <arg name="map_path" default="$(find nav_staff)/map/"/>
  <arg name="map_file" default="5-12.yaml"/>
  <arg name="frame_id"   default="map"/>
  <arg name="use_map_topic"   default="map"/>
  <arg name="initial_pose_x" default="0.0"/>
  <arg name="initial_pose_y" default="0.0"/>
  <arg name="initial_pose_a" default="0.0"/>

  <!-- Run the map server with the desired map -->
  <node name="map_server" pkg="nav_staff" type="ReadMap.py" >
   <param name="map_path"   value="$(arg map_path)"/>
   <param name="map_file"   value="$(arg map_file)"/>
   <param name="frame_id"   value="$(arg frame_id)"/>
   <param name="use_map_topic"   value="$(arg use_map_topic)"/>
  </node>

  <!--amcl-->
  <include file="$(find nav_staff)/launch/xml/amcl_xu.launch.xml">
   <arg name="initial_pose_x"   value="$(arg initial_pose_x)"/>
   <arg name="initial_pose_y"   value="$(arg initial_pose_y)"/>
   <arg name="initial_pose_a"   value="$(arg initial_pose_a)"/>
  </include>

  <!--move base-->
  <include file="$(find nav_staff)/launch/xml/move_base_xu.launch.xml">
   <arg name="custom_param_file"       value="$(arg custom_param_file)"/>
  </include>
    
  <!-- Laserscan topic -->
  <arg name="scan_topic" default="scan"/>
  <arg name="scan_processing" default="true"/>
  <arg name="scan_height"      default="100"/>
  
   <!-- Factory-calibrated depth registration -->
  <arg name="depth_registration"              default="true"/>
  <arg     if="$(arg depth_registration)" name="depth" value="depth_registered" />
  <arg unless="$(arg depth_registration)" name="depth" value="depth" />
  <arg name="camera"      default="camera"/>
  
   <!--Laserscan-->
  <group if="$(arg scan_processing)">
   <node pkg="nodelet" type="nodelet" name="depthimage_to_laserscan" args="load depthimage_to_laserscan/DepthImageToLaserScanNodelet $(arg camera)/$(arg camera)_nodelet_manager">
    <param name="scan_height" value="$(arg scan_height)"/>
    <param name="output_frame_id" value="/$(arg camera)_depth_frame"/>
    <param name="range_min" value="0.45"/>
    <param name="range_max" value="10.0"/>
    <remap from="image" to="$(arg camera)/$(arg depth)/image_raw"/>
    <remap from="scan" to="$(arg scan_topic)"/>
    <remap from="$(arg camera)/image" to="$(arg camera)/$(arg depth)/image_raw"/>
    <remap from="$(arg camera)/scan" to="$(arg scan_topic)"/>
   </node>
  </group>
    
</launch>

